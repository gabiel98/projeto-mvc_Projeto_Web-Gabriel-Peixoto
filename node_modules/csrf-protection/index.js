const crypto = require('crypto');
const csrfTokenControlMiddleware = require('./lib/csrfTokenControlMiddleware');
const csrfTokenMiddleware = require('./lib/csrfTokenMiddleware')

'use strict';

const configureSettings = (options) => {
	const hash = crypto.createHash('sha256');
	const guid = crypto.randomBytes(24).toString('hex');
	hash.update(options.secret);
	hash.update(guid);
	
	const key = hash.digest().toString('hex').slice(0, 32);
	const iv = crypto.randomBytes(16);

	return { 
		csrfCheck : csrfTokenControlMiddleware(key, iv, guid),
		csrfCreate : csrfTokenMiddleware(key, iv, guid)
	}
};

module.exports = configureSettings;
